% documentation.tex: generate .svg files used in DOCUMENTATION.md.
\documentclass[12 pt]{article}

\input{config}

\begin{document}

% Problem Statement table =====================================================

% InferredContinuousROM, IntrusiveContinuousROM  ------------------------------
\begin{align*}
    \ddt\xfom(t)
    = \ffom(t,\xfom(t),\ufom(t))
\end{align*}

% InferredDiscreteROM, IntrusiveDiscreteROM -----------------------------------
\begin{align*}
    \xfom_{j+1}
    = \ffom(\xfom_{j},\ufom_{j})
\end{align*}

% InferredSteadyROM, IntrusiveSteadyROM ---------------------------------------
\begin{align*}
    \gfom
    = \ffom(\xfom,\ufom)
\end{align*}

% InterpolatedInferredContinuousROM  ------------------------------------------
\begin{align*}
    \ddt\xfom(t;\sparam)
    = \ffom(t,\xfom(t;\sparam),\ufom(t);\sparam)
\end{align*}

% InterpolatedInferredDiscreteROM  --------------------------------------------
\begin{align*}
    \xfom_{j+1}(\sparam)
    = \ffom(\xfom_{j}(\sparam),\ufom_{j};\sparam)
\end{align*}

% InterpolatedSteadyROM -------------------------------------------------------
\begin{align*}
    \gfom(\sparam)
    = \ffom(\xfom(\sparam),\ufom;\sparam)
\end{align*}

% AffineInferredContinuousROM, AffineIntrusiveContinuousROM -------------------
\begin{align*}
    \ddt\xfom(t;\vparam)
    = \ffom(t,\xfom(t;\vparam),\ufom(t);\vparam)
\end{align*}

% AffineInferredDiscreteROM, AffineIntrusiveDiscreteROM -----------------------
\begin{align*}
    \xfom_{j+1}(\vparam)
    = \ffom(\xfom_{j}(\vparam),\ufom_{j};\vparam)
\end{align*}

% AffineInferredSteadyROM, AffineIntrusiveSteadyROM ---------------------------
\begin{align*}
    \gfom(\vparam)
    = \ffom(\xfom(\vparam),\ufom;\vparam)
\end{align*}

% Modelform terms table =======================================================

% Continuous / Discrete constant ----------------------------------------------
\begin{align*}
    \crom
\end{align*}

% Continuous linear -----------------------------------------------------------
\begin{align*}
    \Arom\xrom(t)
\end{align*}

% Discrete linear -------------------------------------------------------------
\begin{align*}
    \Arom\xrom_{j}
\end{align*}

% Continuous quadratic --------------------------------------------------------
\begin{align*}
    \Hrom(\xrom(t) \otimes \xrom(t))
\end{align*}

% Discrete quadratic ----------------------------------------------------------
\begin{align*}
    \Hrom(\xrom_{j} \otimes \xrom_{j})
\end{align*}

% Continuous cubic ------------------------------------------------------------
\begin{align*}
    \Grom(\xrom(t) \otimes \xrom(t) \otimes \xrom(t))
\end{align*}

% Discrete cubic --------------------------------------------------------------
\begin{align*}
    \Grom(\xrom_{j} \otimes \xrom_{j} \otimes \xrom_{j})
\end{align*}

% Continuous input ------------------------------------------------------------
\begin{align*}
    \Brom\ufom(t)
\end{align*}

% Discrete input --------------------------------------------------------------
\begin{align*}
    \Brom\ufom_{j}
\end{align*}

% Modelform examples table ====================================================

% Continuous "A" --------------------------------------------------------------
\begin{align*}
    \ddt\xrom(t)
    = \Arom\xrom(t)
\end{align*}

% Discrete "A" ----------------------------------------------------------------
\begin{align*}
    \xrom_{j+1}
    = \Arom\xrom_{j}
\end{align*}

% Continuous "cA" -------------------------------------------------------------
\begin{align*}
    \ddt\xrom(t)
    = \crom + \Arom\xrom(t)
\end{align*}

% Discrete "cA" ---------------------------------------------------------------
\begin{align*}
    \xrom_{j+1}
    = \crom + \Arom\xrom_{j}
\end{align*}

% Continuous "HB" -------------------------------------------------------------
\begin{align*}
    \ddt\xrom(t)
    = \Hrom(\xrom(t) \otimes \xrom(t)) + \Brom\ufom(t)
\end{align*}

% Discrete "HB" ---------------------------------------------------------------
\begin{align*}
    \xrom_{j+1}
    = \Hrom(\xrom_{j} \otimes \xrom_{j}) + \Brom\ufom_{j}
\end{align*}

% Continuous "cAHB" -----------------------------------------------------------
\begin{align*}
    \ddt\xrom(t)
    = \crom + \Arom\xrom(t) + \Hrom(\xrom(t) \otimes \xrom(t)) + \Brom\ufom(t)
\end{align*}

% Discrete "cAHB" -------------------------------------------------------------
\begin{align*}
    \xrom_{j+1}
    = \crom + \Arom\xrom_{j} + \Hrom(\xrom_{j} \otimes \xrom_{j}) + \Brom\ufom_{j}
\end{align*}

% ROM classes =================================================================

% InferredContinuousROM, IntrusiveContinuousROM  ------------------------------
\begin{align*}
    \ddt\xfom(t)
    = \ffom(t,\xfom(t),\ufom(t)),
    \qquad
    \xfom(0)
    = \xfom_0,
\end{align*}

% InterpolatedInferredContinuousROM  ------------------------------------------
\begin{align*}
    \ddt\xfom(t;\sparam)
    = \ffom(t,\xfom(t;\sparam),\ufom(t);\sparam),
    \qquad
    \xfom(0;\sparam)
    = \xfom_0(\sparam),
    \qquad
    \sparam\in\RR,
\end{align*}

% InterpolatedInferredContinuousROM  ------------------------------------------
\begin{align*}
    \xfom_{j+1}(\sparam)
    = \ffom(\xfom_{j}(\sparam),\ufom_{j};\sparam),
    \qquad
    \sparam\in\RR,
\end{align*}

% IntrusiveContinuousROM, IntrusiveDiscreteROM (intrusive projection) ---------
\begin{gather*}
    \crom = \Vr\trp\cfom,
    \qquad
    \Arom = \Vr\trp\Afom\Vr,
    \qquad
    \Hrom = \Vr\trp\Hfom(\Vr \otimes \Vr),
    \\
    \Grom = \Vr\trp\Gfom(\Vr \otimes \Vr \otimes \Vr),
    \qquad
    \Brom = \Vr\trp\Bfom,
\end{gather*}

% AffineInferredContinuousROM, AffineIntrusiveContinuousROM -------------------
\begin{align*}
    \ddt\xfom(t;\vparam)
    = \ffom(t,\xfom(t;\vparam),\ufom(t);\vparam),
    \qquad
    \xfom(0;\vparam)
    = \xfom_0(\vparam),
    \qquad
    \vparam\in\RR^{p},
\end{align*}

% Affine parametric structure -------------------------------------------------
\begin{align*}
    \Afom(\vparam)
    = \sum_{\ell=1}^{q} \theta_{\ell}(\vparam)\Afom_{\ell},
    \qquad
    \theta_{\ell}:\RR^{p}\to\RR,
    \qquad
    \Afom_{\ell}\in\RR^{n \times n}.
\end{align*}

% Affine intrusive projection -------------------------------------------------
\begin{align*}
    \Arom(\vparam)
    = \Vr\trp\Afom(\vparam)\Vr
    = \sum_{\ell=1}^{q}\theta_{\ell}(\vparam)\Vr\trp\Afom_{\ell}\Vr.
\end{align*}

% AffineInferredDiscreteROM, AffineIntrusiveDiscreteROM -----------------------
\begin{align*}
    \xfom_{j+1}(\vparam)
    = \ffom(\xfom_{j}(\vparam),\ufom_{j};\vparam),
    \qquad
    \vparam\in\RR^{p},
\end{align*}

% AffineInferredSteadyROM, AffineIntrusiveSteadyROM ---------------------------
\begin{align*}
    \gfom(\vparam)
    = \ffom(\xfom(\vparam),\ufom;\vparam),
    \qquad
    \vparam\in\RR^{p},
\end{align*}

% Preprocessing ===============================================================

% Cumulative energy -----------------------------------------------------------
\begin{align*}
    \kappa_r
    = \frac{\sum_{i=1}^{r}\sigma_i^2}{\sum_{i=1}^{n}\sigma_i^2}.
\end{align*}

% Projection error ------------------------------------------------------------
\begin{align*}
    \texttt{proj\_err}
    = \frac{\|\Xfom - \Vr\Vr\trp\Xfom\|_F}{\|\Xfom\|_F}.
\end{align*}

% Absolute / relative error ---------------------------------------------------
\begin{align*}
    \texttt{abs\_error}
    = \|\mathbf{X} - \mathbf{Y}\|,
    \qquad
    \texttt{rel\_error}
    = \frac{\texttt{abs\_error}}{\|\mathbf{X}\|}
    = \frac{\|\mathbf{X} - \mathbf{Y}\|}{\|\mathbf{X}\|}.
\end{align*}

% Frobenius norm --------------------------------------------------------------
\begin{align*}
    \|\Xfom\|_{F}
    = \sqrt{\textrm{tr}(\Xfom\trp\Xfom)}
    = \left(\sum_{i=1}^{n}\sum_{j=1}^{k}|x_{ij}|^2\right)^{1/2}.
\end{align*}

% lp error --------------------------------------------------------------------
\begin{align*}
    \|\xfom\|_{\ell^p}
    = \begin{cases}
    \left(\displaystyle\sum_{i=1}^{n}|x_i|^p\right)^{1/p} & p < \infty,
    \\ & \\
    \underset{i=1,\ldots,n}{\textrm{sup}}|x_i| & p = \infty.
    \end{cases}
\end{align*}

% normalized absolute error ---------------------------------------------------
\begin{align*}
    \textrm{norm\_abs\_error}_j
    = \frac{\|\xfom_j - \mathbf{y}_j\|_{\ell^p}}{\max_{l=1,\ldots,k}\|\xfom_l\|_{\ell^p}},
    \quad
    j = 1,\ldots,k.
\end{align*}

% Lp norm ---------------------------------------------------------------------
\begin{align*}
    \|\xfom(\cdot)\|_{L^p([a,b])}
    = \begin{cases}
    \left(\displaystyle\int_{a}^{b}\|\xfom(t)\|_{\ell^p}^p\:dt\right)^{1/p} & p < \infty,
    \\ & \\
    \sup_{t\in[a,b]}\|\xfom(t)\|_{\ell^\infty} & p = \infty.
    \end{cases}
\end{align*}

% Trapezoidal rule for Lp norm ------------------------------------------------
\begin{gather*}
    \int_{a}^{b}\|\xfom(t)\|_{\ell^p}^{p}\:dt
    \approx \delta t\left(
        \frac{1}{2}\|\xfom(t_0)\|_{\ell^p}^p
        + \sum_{j=1}^{k-2}\|\xfom(t_j)\|_{\ell^p}^p
        + \frac{1}{2}\|\xfom(t_{k-1})\|_{\ell^p}^p
    \right),
    \\
    a = t_0 < t_1 < \cdots < t_{k-1} = b.
\end{gather*}

% Utility functions ===========================================================

% Regularized least squares ---------------------------------------------------

\begin{align*}
    \min_{\xfom}\|\mathbf{A}\mathbf{x} - \mathbf{b}\|_{\ell^2}^2 + \|\Reg\mathbf{x}\|_{\ell^2}^2
\end{align*}

\end{document}
